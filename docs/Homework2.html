<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Homework 2 - Statistics & Cybersecurity</title>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f7;
      color: #1d1d1f;
      -webkit-font-smoothing: antialiased;
    }

    header {
      text-align: center;
      padding: 3rem 1rem 2rem;
    }

    h1 {
      font-weight: 600;
      font-size: 2rem;
      letter-spacing: -0.02em;
      color: #1d1d1f;
      margin-bottom: 2rem;
    }

    .content {
      max-width: 800px;
      margin: 0 auto 3rem;
      background-color: #fff;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      line-height: 1.6;
      color: #1d1d1f;
    }

    .content h2 {
      font-size: 1.25rem;
      margin-top: 1.5rem;
      color: #1d1d1f;
    }

    .content p, .content ul{
      margin-top: 0.75rem;
      font-size: 1rem;
      color: #3c3c43;
    }

    .content ul {
      padding-left: 1.5rem;
    }

    .content img {
      display: block;
      margin: 1.5rem auto;
      max-width: 90%;
      height: auto;
      border-radius: 10px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.12);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .content img:hover {
      transform: scale(1.02);
      box-shadow: 0 6px 20px rgba(0,0,0,0.18);
    }

    .back-button {
      display: block;
      text-align: center;
      width: fit-content;
      margin: 2rem auto 0;
      padding: 0.75rem 1.5rem;
      background-color: #6e6e73;
      color: #fff;
      text-decoration: none;
      font-weight: 500;
      font-size: 1rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      transition: all 0.25s ease;
    }

    .back-button:hover {
      background-color: #5e5e63;
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
      transform: translateY(-2px);
    }

    footer {
      text-align: center;
      color: #86868b;
      font-size: 0.85rem;
      margin-top: 4rem;
      padding-bottom: 2rem;
    }

    pre {
      max-height: 300px;
      overflow-y: auto;
      background-color: #f0f0f0;
      padding: 1rem;
      border-radius: 8px;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

  </style>
</head>
<body>

  <header>
    <h1>HomeWork 2 - Explain the concept of dataset and distribution</h1>
  </header>

  <main>
    <div class="content">
      <h2>What is a dataset?</h2>
      <p>A dataset is a structured collection of data organized and stored togheter for analysis or processing. The data within a dataset is tipically related in some way and is ofted derived from a single source or created for a specific project. A dataset may contain various types of data, such as numerical values, text, images, or audio recordings. Its content can usually be accessed individuallu, combined, or managed as a single entity.</p>

      <p>Dataset serves many purpose, including training and testing machine learning models, data visualization, research, and statistical analysis. The main difference between a dataset and a database is that a dataset is typically smaller in size, while a database is a larger, organized collection of data composed by multiple datasets. Database also provide mechanisms to easily access, manipulate, and updates the stored data.</p>

      <h2>What is a distribution?</h2>
      <p>In statistics, a distribution is a function that describes the possible values a variable can take and how frequently each value occurs. It provides a mathematical representation of the data's behavior, indicating where most observations are concentrated and how the data are spread out.</p>
      
      <p>Distributions can be expressed in various forms, such as probability density functions for continuous data or probability mass functions for discrete data.</p>

      <p>Statistical data distributions are generally classified into two main categories:</p>
      <ul>
        <li>Discrete distribution: used when the variable can assume only specific countable values.</li>
        <li>Continuous distribution: used when the variale can take any value within a given range, including fractions and decimals.</li>
      </ul>

      <h2>Access Dataset</h2>
      <img src="img/Dataset.png" alt="Dataset">

      <p>The "Champion" dataset has been created, consisting of the following attributes:</p>
      <ul>
        <li>ID: primary key</li>
        <li>champ_name</li>
        <li>champ_age</li>
        <li>champ_country</li>
        <li>champ_score</li>
      </ul>
      <p>Realized by using the following query:</p>
      <pre>
        CREATE TABLE "Champion" (
            Id INTEGER PRIMARY KEY,
            champ_name STRING,
            champ_age INTEGER,
            champ_country STRING,
            champ_score INTEGER
        );
        </pre>        

      <h2>Univariate Distribution</h2>
      <img src="img/UnivarientDistribution.png" alt="Univariate query">

      <p>The image shows the result of a Sql query in Microsoft Access that displays a univariate distribution of the variable "champ_age", indicating the frequency of each age value in the dataset.</p>
      <p>Realized by using the following query:</p>

      <pre>
      SELECT champ_age,
      COUNT(*) AS frequency
      FROM Champion
      GROUP BY champ_age
      </pre>   

      <h2>Bivariate Distribution</h2>
      <img src="img/BiVarientDistribution.png" alt="Bivariate query">

      <p>The image shows the result of a bivariate distribution query in Microsoft Access, displaying the relationship between "champ_age" and "champ_country", along with the frequency of each age-country combination in the dataset.</p>
      <p>Realized by using the following query:</p>

      <pre>
      SELECT champ_age,
      champ_country,
      COUNT(*) AS frequency
      FROM Champion
      GROUP BY champ_age,
      champ_country
      </pre>  

      <h2>Text analysis and Caeser Cipher</h2>
      <p>This section analyzes a text taken from a web page, computes the distribution of letters, applies a Caesar Cipher, and the tries to decode it using frequency analysis.</p>

      <textarea id="inputText" rows="5" placeholder="Insert text here"></textarea>

      <div>
        <button onclick="analyzeText()">Analyze Distribution</button>
        <button onclick="encryptText()">Apply Caesar Cipher</button>
        <button onclick="bruteForceDecrypt()">Decode (Brute Force)</button>
        <button onclick="frequencyDecode()">Decode (Frequency Analysis)</button>
      </div>
      
      <pre id="Output"></pre>

      <h2>Functionality explaination</h2>
      <ul>
        <li><strong>Analyze Distribution</strong>: this function analyzes the text and computes the frequency distribution of letters (A-Z). It shows how often each letter appears, which is a fundamental concept in statistics and cryptanalysis, as it helps identify patterns and irregularities in the data.</li>
        <li><strong>Apply Caesar Cipher</strong>: this function encrypts the text using the <strong>Caesar Cipher</strong>, a simple substitution cipher where each letter in the plaintext is shifted by a fixed number of positions in the alphabet. It demonstrates one of the earliest forms of encryption, showing how basic transformations can conceal the original message.</li>
        <li><strong>Decode (Brute Force)</strong>: this function attemps to decrypt the encrypted text by trying all possible shifts (from 1 to 25). Since Caeser Cipher has only a limited number of possible keys, this brute-force attach can quickly reveal the orignal plaintext.</li>
        <li><strong>Decode (Frequency Analysis)</strong>: this function decrypts the message by comparing the letter frequency distribution of the encrypted text to that of a known language (e.g. English). It assumes that the most frequent letter in the ciphtertext corresponds to the most frequent letter in the language (often E in English).</li>
      </ul>

      <h3>⚠️Problems⚠️</h3>
      <p>When using a simple frequency analysis to decode a Caesar Cipher, the algorithm aften assumes that the most frequent letter in the encrypted text corresponds to the most frequent letter in the target language (for example, "E" in English). However this assumption can fail for short or unbalanced texts, where the most common letter in the message in not actually "E".</p>

      <button onclick="improvedFrequencyDecode()">Decode (Chi-Square Analysis)</button>

      <p>The <strong>Chi-Square analysis</strong> enhances the accuracy of Caesar Chiper decryption by using statistical letter frequency analysis. Instead of assuming that the most frequent letter in the encrypted text corresponds to "E", it tries all possible shifts and compares the observed letter distribution of each decryption with the expected distribution of the language. The shift that produces the lowest Chi-Square values is chosen, yielding a more reliable decryption even for short or unbalanced texts.</p>

      <a class="back-button" href="../index.html">← Back</a>
    </div>
  </main>

  <footer>
    © 2025 Gabriele Paladini — Tutti i diritti riservati
  </footer>

  <script>
    let encryptedText = "";
    const englishFreq = {
      E: 12.7, T: 9.1, A: 8.2, O: 7.5, I: 7.0, N: 6.7, S: 6.3, H: 6.1,
      R: 6.0, D: 4.3, L: 4.0, C: 2.8, U: 2.8, M: 2.4, W: 2.4, F: 2.2,
      G: 2.0, Y: 2.0, P: 1.9, B: 1.5, V: 1.0, K: 0.8, J: 0.2, X: 0.2, Q: 0.1, Z: 0.1
    };

    function analyzeText() {
      const text = document.getElementById("inputText").value.toUpperCase();
      if (!text){
        document.getElementById("Output").textContent = "Inserisci del testo prima di analizzare."
        return;
      }
      const freq = {};
      let total = 0;

      for (let c of text) {
        if (/[A-Z]/.test(c)) {
          freq[c] = (freq[c] || 0) + 1;
          total++;
        }
      }

      if (total === 0){
        document.getElementById("Output").textContent = "Nessuna lettera A-Z trovata nel testo.";
        return;
      }

      const distribution = Object.keys(freq)
        .sort()
        .map(l => `${l}: ${(freq[l] / total * 100).toFixed(2)}%`)
        .join("\n");

      document.getElementById("Output").textContent = "Letter distribution:\n\n" + distribution;
    }

    function caesarEncrypt(text, shift) {
      return text.toUpperCase().replace(/[A-Z]/g, c =>
        String.fromCharCode((c.charCodeAt(0) - 65 + shift) % 26 + 65)
      );
    }

    function encryptText() {
      const text = document.getElementById("inputText").value;
      const shift = 3;
      encryptedText = caesarEncrypt(text, shift);
      document.getElementById("Output").textContent = "Encrypted text:\n\n" + encryptedText;
    }

    function caesarDecrypt(text, shift) {
      return caesarEncrypt(text, 26 - shift);
    }

    function bruteForceDecrypt() {
      if (!encryptedText) return alert("Encrypt a text first!");
      let results = "";
      for (let s = 1; s < 26; s++) {
        results += `Shift ${s} → ${caesarDecrypt(encryptedText, s)}\n\n`;
      }
      document.getElementById("Output").textContent = results;
    }

    function frequencyDecode() {
      if (!encryptedText) return alert("Encrypt a text first!");
      const freq = {};
      let total = 0;

      for (let c of encryptedText.toUpperCase()) {
        if (/[A-Z]/.test(c)) {
          freq[c] = (freq[c] || 0) + 1;
          total++;
        }
      }

      const maxLetter = Object.entries(freq).sort((a, b) => b[1] - a[1])[0][0];
      const shift = (maxLetter.charCodeAt(0) - 'E'.charCodeAt(0) + 26) % 26;
      const decrypted = caesarDecrypt(encryptedText, shift);

      document.getElementById("Output").textContent =
        `Estimated shift: ${shift}\n\nDecrypted text (based on letter frequency):\n\n${decrypted}`;
    }

    function getFrequency(text) {
    const freq = {};
    let total = 0;
    for (let c of text.toUpperCase()) {
      if (/[A-Z]/.test(c)) {
        freq[c] = (freq[c] || 0) + 1;
        total++;
      }
    }
    for (let c in freq) freq[c] = (freq[c] / total) * 100;
    return freq;
  }

    function chiSquareStatistics(observed) {
      let chi = 0;
      for (let letter in englishFreq) {
        const observedFreq = observed[letter] || 0;
        const expectedFreq = englishFreq[letter];
        chi += Math.pow(observedFreq - expectedFreq, 2) / expectedFreq;
      }
      return chi;
    }

    function improvedFrequencyDecode() {
      if (!encryptedText) return alert("Encrypt a text first!");

      let bestShift = 0;
      let lowestChi = Infinity;
      let bestDecryption = "";

      for (let shift = 0; shift < 26; shift++) {
        const decrypted = caesarDecrypt(encryptedText, shift);
        const freq = getFrequency(decrypted);
        const chi = chiSquareStatistics(freq);

        if (chi < lowestChi) {
          lowestChi = chi;
          bestShift = shift;
          bestDecryption = decrypted;
        }
      }

      document.getElementById("Output").textContent =
        `Estimated shift: ${bestShift}\nChi-Square value: ${lowestChi.toFixed(2)}\n\nDecrypted text:\n\n${bestDecryption}`;
    }
  </script>
</body>
</html>
